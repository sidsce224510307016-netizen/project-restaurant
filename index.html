<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rialto | Smart Order</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { background: #0b0e14; color: white; font-family: sans-serif; margin: 0; }
        .hero { height: 100vh; display: flex; align-items: center; justify-content: center; background: url('https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=1200') center/cover; }
        .glass-box { background: rgba(0,0,0,0.8); padding: 30px; border-radius: 20px; width: 300px; text-align: center; border: 1px solid #333; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #222; color: white; box-sizing: border-box; }
        .primary-btn { width: 100%; background: #ffb300; color: black; padding: 15px; border-radius: 10px; font-weight: bold; border: none; cursor: pointer; }
        
        #menu-section { padding: 40px 20px; }
        .card { background: #161b22; padding: 20px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border: 1px solid #30363d; }
        
        /* THE LOCK STYLE */
        .add-btn { background: #ffb300; color: black; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .locked { background: #444 !important; color: #888 !important; opacity: 0.5; pointer-events: none; }
    </style>
</head>
<body>

    <section class="hero" id="hero-area">
        <div class="glass-box">
            <h1>Rialto</h1>
            <select id="orderType" onchange="toggleInputs()">
                <option value="Dine In">Dine In</option>
                <option value="Takeaway">Takeaway</option>
            </select>
            <input type="text" id="custName" placeholder="Your Name">
            <input type="number" id="partySize" placeholder="Number of People">
            <button class="primary-btn" onclick="startSession()">CONFIRM & VIEW MENU</button>
        </div>
    </section>

    <section id="menu-section">
        <h2>Menu</h2>
        <div class="card">
            <div><h4>Paneer Tikka</h4><p>₹220</p></div>
            <button class="add-btn locked" onclick="placeOrder('Paneer Tikka')">Add</button>
        </div>
        <div class="card">
            <div><h4>Butter Chicken</h4><p>₹450</p></div>
            <button class="add-btn locked" onclick="placeOrder('Butter Chicken')">Add</button>
        </div>
    </section>

    <script>
        // REPLACE WITH YOUR ACTUAL KEYS
        const supabase = supabase.createClient('YOUR_SUPABASE_URL', 'YOUR_KEY');

        let userSession = { active: false, name: '', type: '', size: 0 };

        function toggleInputs() {
            const type = document.getElementById('orderType').value;
            const sizeInput = document.getElementById('partySize');
            // Hide/Show people input
            sizeInput.style.display = (type === 'Takeaway') ? 'none' : 'block';
        }

        function startSession() {
            const name = document.getElementById('custName').value;
            const type = document.getElementById('orderType').value;
            const size = document.getElementById('partySize').value;

            if (!name) return alert("Please enter your name");
            if (type === 'Dine In' && !size) return alert("Please enter number of people");

            // 1. Save data
            userSession.active = true;
            userSession.name = name;
            userSession.type = type;
            userSession.size = (type === 'Takeaway') ? 1 : parseInt(size);

            // 2. UNLOCK BUTTONS (Force)
            const allButtons = document.querySelectorAll('.add-btn');
            allButtons.forEach(btn => {
                btn.classList.remove('locked'); // This removes the grey look
            });

            // 3. Scroll & Hide Hero
            document.getElementById('hero-area').style.display = 'none';
            window.scrollTo(0,0);
            alert("Welcome " + name + "! You can now add items to your order.");
        }

        async function placeOrder(itemName) {
            if (!userSession.active) return alert("Please confirm your details at the top first!");

            const { error } = await supabase.from('orders').insert([{
                customer_name: userSession.name,
                party_size: userSession.size,
                items: { item: itemName },
                order_type: userSession.type,
                status: 'Pending'
            }]);

            if (!error) {
                alert(itemName + " added!");
            } else {
                alert("Database Error: " + error.message);
            }
        }
    </script>
</body>
</html>